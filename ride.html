<!DOCTYPE html>
<html class="no-js" lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Book a Ride - Rides</title>

    <link rel="stylesheet" href="css/font.css" />
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/ride.css" />
    <link rel="stylesheet" href="/css/message.css" />
    <link rel="stylesheet" href="https://js.arcgis.com/4.6/esri/css/main.css" />

    <script src="js/vendor/modernizr.js"></script>
  </head>
  <body class="page-book">
    <header class="site-header">
      <div class="site-logo">Rides</div>

      <nav class="site-nav">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="faq.html">FAQ</a></li>
          <li><a href="#" id="navSignOut">Sign Out</a></li>
        </ul>
      </nav>
      <button type="button" class="btn-menu"><span>Menu</span></button>
    </header>

    <main class="booking-container">
      <div class="booking-heading">
        <h1>Book Your Ride</h1>
        <p>
          Choose your pickup and destination, review a live fare estimate, and
          confirm your booking. Everything runs against your AWS-backed API so
          the pricing and confirmations match production behaviour.
        </p>
      </div>
      <div class="booking-layout">
        <div class="booking-column">
          <section class="booking-card map-card">
            <div class="map-card-header">
              <h2>Map Selection</h2>
              <div class="map-mode-toggle" role="group">
                <button
                  type="button"
                  class="btn-secondary active"
                  id="mapModePickup"
                  data-mode="pickup"
                >
                  Set Pickup
                </button>
                <button
                  type="button"
                  class="btn-secondary"
                  id="mapModeDropoff"
                  data-mode="dropoff"
                >
                  Set Destination
                </button>
              </div>
            </div>
            <div class="map-wrapper">
              <div id="map" aria-label="Ride map selection area"></div>
            </div>
            <div class="map-selection-details" id="mapSelectionDetails">
              Click the map to place a marker for your pickup point. Switch the
              toggle above to set a destination marker.
            </div>
          </section>

          <section class="booking-card">
            <h2>Ride Details</h2>
            <form id="bookingForm">
              <input type="hidden" id="pickupLat" name="pickupLat" />
              <input type="hidden" id="pickupLng" name="pickupLng" />
              <input type="hidden" id="dropoffLat" name="dropoffLat" />
              <input type="hidden" id="dropoffLng" name="dropoffLng" />
              <div class="booking-form-group">
                <label for="pickup">Pickup Location</label>
                <input
                  id="pickup"
                  name="pickup"
                  type="text"
                  placeholder="Street, City, Postcode"
                  autocomplete="off"
                  required
                />
              </div>
              <div class="booking-form-group">
                <label for="dropoff">Destination</label>
                <input
                  id="dropoff"
                  name="dropoff"
                  type="text"
                  placeholder="Street, City, Postcode"
                  autocomplete="off"
                  required
                />
              </div>
              <div class="booking-form-group booking-inline">
                <div>
                  <label for="pickupTime">Pickup Time</label>
                  <input
                    id="pickupTime"
                    name="pickupTime"
                    type="datetime-local"
                    required
                  />
                </div>
                <div>
                  <label for="rideType">Ride Type</label>
                  <select id="rideType" name="rideType">
                    <option value="standard" selected>Standard</option>
                    <option value="executive">Executive</option>
                    <option value="xl">XL</option>
                    <option value="green">Green</option>
                  </select>
                </div>
              </div>
              <div class="booking-form-group booking-inline">
                <div>
                  <label for="passengers">Passengers</label>
                  <input
                    id="passengers"
                    name="passengers"
                    type="number"
                    min="1"
                    max="6"
                    value="1"
                  />
                </div>
                <div>
                  <label for="luggage">Luggage Pieces</label>
                  <input
                    id="luggage"
                    name="luggage"
                    type="number"
                    min="0"
                    max="6"
                    value="0"
                  />
                </div>
              </div>
              <div class="booking-form-group booking-inline">
                <div>
                  <label for="distanceHint">Estimated Distance (km)</label>
                  <input
                    id="distanceHint"
                    name="distanceHint"
                    type="number"
                    step="0.1"
                    min="1"
                    placeholder="Optional"
                  />
                </div>
                <div>
                  <label for="durationHint">Estimated Duration (min)</label>
                  <input
                    id="durationHint"
                    name="durationHint"
                    type="number"
                    step="1"
                    min="5"
                    placeholder="Optional"
                  />
                </div>
              </div>
              <div class="booking-form-group">
                <label for="notes">Driver Notes</label>
                <textarea
                  id="notes"
                  name="notes"
                  placeholder="Building access, pickup instructions, anything the driver should know."
                ></textarea>
              </div>
              <div class="booking-form-actions">
                <button class="btn-secondary" id="estimateButton">
                  Update Fare Estimate
                </button>
                <button class="btn-primary" id="confirmButton" disabled>
                  Confirm Booking
                </button>
              </div>
            </form>
          </section>
        </div>

        <aside class="fare-summary">
          <div class="booking-card fare-breakdown">
            <h2>Fare Summary</h2>
            <div class="fare-total">
              <span class="amount" id="fareTotal">--</span>
              <span class="descriptor">Estimated Total</span>
            </div>
            <div id="fareBreakdownRows">
              <div class="fare-row">
                <span>Base Fare</span>
                <strong id="fareBase">--</strong>
              </div>
              <div class="fare-row">
                <span>Distance</span>
                <strong id="fareDistance">--</strong>
              </div>
              <div class="fare-row">
                <span>Time</span>
                <strong id="fareTime">--</strong>
              </div>
              <div class="fare-row">
                <span>Taxes & Fees</span>
                <strong id="fareFees">--</strong>
              </div>
            </div>
            <div class="estimate-meta" id="estimateMeta">
              <div class="meta-item">
                <span>Distance</span>
                <span id="metaDistance">--</span>
              </div>
              <div class="meta-item">
                <span>Duration</span>
                <span id="metaDuration">--</span>
              </div>
              <div class="meta-item">
                <span>Surge</span>
                <span id="metaSurge">--</span>
              </div>
            </div>
          </div>

          <div class="booking-card ride-history">
            <div class="ride-history-header">
              <h3>Recent Bookings</h3>
              <button class="btn-secondary" id="refreshHistory">Refresh</button>
            </div>
            <div id="historyRows" class="ride-history-empty">
              No rides booked yet.
            </div>
          </div>

          <div class="booking-status" id="bookingStatus">
            <div class="status-heading">Status</div>
            <div class="status-body" id="statusBody">
              Update fare estimate to see pricing details.
            </div>
            <div class="status-meta" id="statusMeta"></div>
          </div>
        </aside>
      </div>
    </main>

    <script src="js/vendor/jquery-3.1.0.js"></script>
    <script src="js/vendor/aws-cognito-sdk.min.js"></script>
    <script src="js/vendor/amazon-cognito-identity.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/cognito-auth.js"></script>
    <script src="js/main.js"></script>
    <script src="https://js.arcgis.com/4.6/"></script>
    <script src="js/esri-map.js"></script>
    <script src="js/booking.js"></script>
  </body>
</html>
